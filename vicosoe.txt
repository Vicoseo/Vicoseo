============================================================
  MULTI-TENANT CMS - 18 OZELLIK GELISTIRME PLANI (vicosoe)
============================================================

Tarih: 17 Subat 2026
Sistem: Laravel 11 Backend + Next.js 15 Frontend + Vue 2.7 Admin Panel
Mimari: Multi-tenant (landlord/tenant DB ayirimi), Sanctum Auth, MySQL

============================================================
FAZ 1 - SPONSOR SISTEMI (Madde 1, 2, 3, 7)
============================================================

1.1 Sponsor Gorsel Yukleme
    - UploadController.php: Multipart dosya yukleme
    - WebP donusumu (GIF/SVG haric), max 2MB, 1200x800 limit
    - ImageUpload.vue: Drag & drop, onizleme, sil/degistir
    - SponsorList ve GlobalOfferList'te URL input yerine gorsel yukleme

1.2 Sponsor Slider/Marquee
    - Sponsors.tsx: CSS marquee ile sonsuz yatay kayma
    - Hover'da durma, sol/sag ok butonlari
    - requestAnimationFrame ile akici animasyon

1.3 Sponsor Kategorileri
    - sponsors tablosuna 'category' ENUM('vip','popular','kutu') eklendi
    - Frontend'de kategori filtreleme butonlari: VIP, Populer, Kutu
    - Admin panelde dropdown ile kategori secimi

1.4 Sponsor Iletisim + Gorunurluk
    - sites tablosuna: sponsor_page_visible, sponsor_contact_url, sponsor_contact_text
    - Frontend'de iletisim alani gosterimi
    - Admin panelde toggle ile acma/kapama

ISLEYIS:
  Admin Panel -> Sponsor ekle/duzenle -> Gorsel yukle -> Kategori sec
  Frontend -> API'den sponsorlari cek -> Kategori filtrele -> Slider goster
  Sponsor gorunurlugu site bazli acilip kapatilabilir

============================================================
FAZ 2 - ADMIN GUVENLIK & YETKILENDIRME (Madde 8, 11)
============================================================

2.1 Coklu Admin + Rol Sistemi
    - users tablosuna: role (master/admin), is_active, permissions JSON
    - admin_site_access pivot tablo: hangi admin hangi siteye erisebilir
    - admin_logs tablo: tum admin islemleri loglanir
    - UserController: Admin CRUD (sadece master erisir)

2.2 Iki Asamali Dogrulama (2FA)
    - TOTP (Google Authenticator) destegi
    - Login akisi: email/sifre -> 2FA kod girisi -> tam token
    - QR kod ile kurulum, etkinlestirme/devre disi birakma

2.3 IP Kisitlama
    - IpRestriction middleware: Kullanicinin allowed_ips listesinde mi kontrol
    - Admin bazli IP beyaz listesi

2.4 Yetki Matrisi
    - 6 yetki: sponsor_manage, redirect_manage, content_generate,
      analytics_view, site_manage, user_manage
    - Master: tum yetkiler otomatik bypass
    - CheckPermission middleware ile route bazli kontrol

ISLEYIS:
  Master admin -> Yeni admin olustur -> Site erisimi ata -> Yetkiler sec
  Admin giris -> Email/sifre -> 2FA kod -> Token al -> Yetkili islemler
  Her POST/PUT/DELETE istegi admin_logs tablosuna yazilir
  IP kisitlama aktifse sadece beyaz listedeki IP'lerden erisim

============================================================
FAZ 3 - SEO ALTYAPISI (Madde 12, 13)
============================================================

3.1 Gelistirilmis Redirect Yonetimi
    - sites tablosuna: fallback_domain
    - Redirect bulunamazsa fallback domain'e 302 yonlendirme
    - Mevcut 301/302/307/308 destegi korundu

3.2 SEO Araclari
    - Sitemap'e <image:image> tag destegi (featured_image olan postlar)
    - sites tablosuna: robots_txt (TEXT), noindex_mode (BOOLEAN)
    - robots.ts: API'den ozel robots.txt cekme
    - layout.tsx: noindex_mode aktifse meta robots noindex ekleme

ISLEYIS:
  Admin -> Site ayarlari -> Fallback domain, robots.txt, noindex modu ayarla
  Frontend -> robots.txt istegi gelince ozel icerik don
  Frontend -> noindex aktifse <meta name="robots" content="noindex"> ekle
  Sitemap -> Her post icin featured_image varsa image tag ekle

============================================================
FAZ 4 - ICERIK SISTEMI (Madde 5, 14, 15, 17)
============================================================

4.1 Otomatik Icerik Planlama
    - content_schedules tablosu: site_id, frequency, run_at, topics, is_active
    - ContentScheduleController: CRUD
    - Scheduler: Her saat content:process-schedules komutu calisir
    - Admin'de site bazli icerik plani olusturma

4.2 Duplicate Icerik Onleme
    - AIContentService'e appendDuplicatePrevention() eklendi
    - Mevcut slug'lari prompt'a ekleyerek tekrar onleme
    - "Her bolum farkli kelimelerle baslamali" talimati

4.3 Icerik Sablon Yonetimi
    - sites tablosuna: content_prompt_template (TEXT)
    - Placeholder destegi: {{brand_name}}, {{domain}}, {{telegram}}, {{login_url}}
    - Her AI uretiminde site ozel sablonu otomatik eklenir

4.4 Icerik Revizyon Sistemi
    - revisions tablosu (tenant): revisionable_type/id, field_name, old/new value
    - HasRevisions trait: Page ve Post'ta otomatik revizyon takibi
    - title, content, meta_title, meta_description alanlari izlenir
    - revertTo($revisionId) ile geri alma

ISLEYIS:
  Admin -> Site detay -> Icerik Plani tab -> Plan olustur (saat, konular)
  Scheduler -> Her saat aktif planlari kontrol et -> AI ile icerik uret
  Admin -> Sayfa/yazi duzenle -> Otomatik revizyon kaydi olusur
  Admin -> Revizyon gecmisi -> "Geri Al" ile eski haline don
  AI prompt'lari site ozel sablonu + duplicate onleme ile zenginlestirilir

============================================================
FAZ 5 - ANALYTICS & ENTEGRASYONLAR (Madde 4, 5, 6)
============================================================

5.1 Google Analytics Veri Cekme
    - GoogleAnalyticsService: GA4 Data API ile veri cekme
    - Metrikler: activeUsers, screenPageViews, sessions, avgSessionDuration
    - Gunluk breakdown + en cok ziyaret edilen sayfalar
    - 1 saat cache TTL

5.2 Analytics Dashboard
    - AnalyticsController: Site bazli + toplu ozet
    - Dashboard'da toplam ziyaretci/sayfa goruntulenme/oturum
    - Site detayda Analytics tab: metrik kartlari + top pages tablosu

5.3 Google Search Console Entegrasyonu
    - GoogleSearchConsoleService: Arama performansi, sitemap yonetimi
    - SearchConsoleController: performance, sitemaps, submit, pages
    - Site detayda GSC tab: tiklanma/gosterim/CTR/pozisyon
    - Sitemap gonderme butonu

ISLEYIS:
  On kosul: Google Cloud'da Service Account + GA4/GSC API enable
  Service Account JSON -> storage/app/google/service-account.json
  Admin -> Dashboard -> Toplam ziyaretci goster (tum sitelerin birlesiimi)
  Admin -> Site detay -> Analytics tab -> Periyot sec -> Verileri gor
  Admin -> Site detay -> GSC tab -> Arama performansi + Sitemap gonder

============================================================
FAZ 6 - ALTYAPI & IZLEME (Madde 9, 10, 16, 18)
============================================================

6.1 Custom CSS
    - sites tablosuna: custom_css (TEXT, max 10KB)
    - Frontend layout.tsx: <style> olarak inject (.page-content scope)
    - Sponsor bolumune etki etmez
    - Admin'de monospace textarea ile CSS editoru

6.2 Log & Hata Izleme
    - LogController: Laravel log dosyasini parse et
    - Seviye filtreleme (error/warning/info/debug/critical)
    - Hata ozet sayilari
    - SystemLogList.vue: Backend loglari + Admin islem loglari tablari

6.3 Rate Limiting
    - RateLimiter middleware:
      - Admin API: 60 istek/dakika
      - Public API: 120 istek/dakika
    - 429 Too Many Requests donusu
    - X-RateLimit-Limit ve X-RateLimit-Remaining header'lari

ISLEYIS:
  Admin -> Site duzenle -> Custom CSS yaz -> Kaydet -> Frontend'de uygulanir
  Admin -> Sistem Loglari -> Seviye filtrele -> Hatalari incele
  API istekleri -> Rate limit kontrolu -> Asimda 429 don
  Her admin istegi loglanir -> Islem Loglari sayfasindan incelenebilir

============================================================
DOSYA YAPISI OZETI
============================================================

YENI BACKEND DOSYALARI:
  - app/Http/Controllers/Admin/UploadController.php
  - app/Http/Controllers/Admin/UserController.php
  - app/Http/Controllers/Admin/TwoFactorController.php
  - app/Http/Controllers/Admin/AdminLogController.php
  - app/Http/Controllers/Admin/ContentScheduleController.php
  - app/Http/Controllers/Admin/AnalyticsController.php
  - app/Http/Controllers/Admin/SearchConsoleController.php
  - app/Http/Controllers/Admin/LogController.php
  - app/Http/Middleware/CheckRole.php
  - app/Http/Middleware/CheckSiteAccess.php
  - app/Http/Middleware/IpRestriction.php
  - app/Http/Middleware/LogAdminAction.php
  - app/Http/Middleware/CheckPermission.php
  - app/Http/Middleware/RateLimiter.php
  - app/Models/AdminLog.php
  - app/Models/ContentSchedule.php
  - app/Models/Revision.php
  - app/Models/Concerns/HasRevisions.php
  - app/Services/GoogleAnalyticsService.php
  - app/Services/GoogleSearchConsoleService.php
  - config/google.php
  - 10 migration dosyasi

YENI ADMIN PANEL DOSYALARI:
  - src/api/upload.js, users.js, logs.js, analytics.js, gsc.js, contentSchedules.js
  - src/components/ImageUpload.vue
  - src/views/users/UserList.vue, UserForm.vue
  - src/views/settings/TwoFactorSetup.vue
  - src/views/logs/AdminLogList.vue, SystemLogList.vue
  - src/views/content/ContentScheduleForm.vue

GUNCELLENEN DOSYALAR:
  Backend: Site.php, User.php, Sponsor.php, Page.php, Post.php,
           AuthController, SponsorController(x2), PageController,
           PostController, SiteController, RedirectController,
           SitemapController, AIContentService, routes/api.php,
           routes/console.php, bootstrap/app.php

  Admin:   Login.vue, Dashboard.vue, SiteForm.vue, SiteDetail.vue,
           SponsorList.vue, GlobalOfferList.vue, PageForm.vue,
           PostForm.vue, Sidebar.vue, router/index.js, pages.js, posts.js

  Frontend: layout.tsx, globals.css, robots.ts, Sponsors.tsx,
            api.ts, types/index.ts

============================================================
ON KOSULLAR
============================================================

1. Google Cloud Console'da proje + Service Account olusturulmali (Faz 5)
2. GA4 ve GSC API'leri enable edilmeli
3. storage:link sunucuda calistirilmis olmali (dosya yukleme)
4. composer require pragmarx/google2fa-laravel (2FA icin)
5. composer require google/apiclient (Google API icin)
6. Migration'lar calistirilmali: php artisan migrate
7. Supervisor queue worker yapilandirmasi guncel olmali

============================================================
